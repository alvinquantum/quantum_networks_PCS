(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     99277,       2386]
NotebookOptionsPosition[     95192,       2312]
NotebookOutlinePosition[     95602,       2328]
CellTagsIndexPosition[     95559,       2325]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "pm", ",", "partialTrace", ",", " ", "single", ",", " ", "czGate", ",", 
    " ", "channel"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pm", "[", "i_", "]"}], ":=", " ", 
    RowBox[{"PauliMatrix", "[", "i", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"partialTrace", "[", 
     RowBox[{"matrix_", ",", "lengths_", ",", "indicesToKeep_"}], "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"matrix", ":", " ", 
      RowBox[{"input", " ", 
       RowBox[{"state", ".", " ", "lengths"}], " ", "are", " ", "the", " ", 
       "dimensions", " ", 
       RowBox[{"e", ".", "g", ".", " ", "3"}], " ", "qubits", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ".", " ", 
        "indicesToKeep"}]}], ":", " ", 
      RowBox[{"qubits", " ", "to", " ", 
       RowBox[{"keep", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indicesToTrace", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", "lengths"}]}], ",", "indicesToKeep"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"matrixInTPForm", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"ArrayReshape", "[", 
             RowBox[{"matrix", ",", 
              RowBox[{"Join", "[", 
               RowBox[{"lengths", ",", "lengths"}], "]"}]}], "]"}], ",", 
            RowBox[{"Join", "@@", 
             RowBox[{"Transpose", "@", 
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"2", " ", 
                  RowBox[{"Length", "@", "lengths"}]}], "]"}], ",", "2"}], 
               "]"}]}]}]}], "]"}]}], "}"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"TensorContract", "[", 
           RowBox[{"matrixInTPForm", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", " ", "#"}], "-", "1"}], ",", 
                RowBox[{"2", " ", "#"}]}], "}"}], "&"}], "/@", 
             "indicesToTrace"}]}], "]"}], ",", 
          RowBox[{"Transpose", "@", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"Length", "@", "lengths"}]}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"Length", "@", "indicesToTrace"}]}]}], "]"}], ",", 
             "2"}], "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"single", "[", 
     RowBox[{"n_", ",", "switch_", ",", "matrix_"}], "]"}], ":=", " ", 
    RowBox[{"(*", 
     RowBox[{"n", ":", " ", 
      RowBox[{"number", " ", "of", " ", 
       RowBox[{"qubits", ".", " ", "switch"}]}], ":", " ", 
      RowBox[{"qubit", " ", "to", " ", "apply", " ", "matrix", " ", "to"}]}], 
     "*)"}], 
    RowBox[{"KroneckerProduct", "@@", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", "n"}], "]"}], ",", 
       RowBox[{"switch", "->", "matrix"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cxGate", "[", 
    RowBox[{"n_", ",", "control_", ",", "target_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Divide", "[", 
     RowBox[{"1", ",", "2"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"2", "^", "n"}], "]"}], "+", 
      RowBox[{"single", "[", 
       RowBox[{"n", ",", " ", "control", ",", " ", 
        RowBox[{"pm", "[", "3", "]"}]}], "]"}], "+", 
      RowBox[{"single", "[", 
       RowBox[{"n", ",", "target", ",", 
        RowBox[{"pm", "[", "1", "]"}]}], "]"}], "-", 
      RowBox[{
       RowBox[{"single", "[", 
        RowBox[{"n", ",", " ", "control", ",", " ", 
         RowBox[{"pm", "[", "3", "]"}]}], "]"}], ".", 
       RowBox[{"single", "[", 
        RowBox[{"n", ",", "target", ",", 
         RowBox[{"pm", "[", "1", "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"czGate", "[", 
     RowBox[{"n_", ",", "control_", ",", "target_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"Divide", "[", 
      RowBox[{"1", ",", "2"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "n"}], "]"}], "+", 
       RowBox[{"single", "[", 
        RowBox[{"n", ",", " ", "control", ",", " ", 
         RowBox[{"pm", "[", "3", "]"}]}], "]"}], "+", 
       RowBox[{"single", "[", 
        RowBox[{"n", ",", "target", ",", 
         RowBox[{"pm", "[", "3", "]"}]}], "]"}], "-", 
       RowBox[{
        RowBox[{"single", "[", 
         RowBox[{"n", ",", " ", "control", ",", " ", 
          RowBox[{"pm", "[", "3", "]"}]}], "]"}], ".", 
        RowBox[{"single", "[", 
         RowBox[{"n", ",", "target", ",", 
          RowBox[{"pm", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"channel", "[", 
     RowBox[{"n_", ",", "switch_", ",", "p_", ",", "state_"}], "]"}], ":=", 
    " ", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Depolarizing", " ", 
      RowBox[{"channel", ".", " ", 
       RowBox[{"n", ":", " ", 
        RowBox[{"number", " ", "of", " ", 
         RowBox[{"qubits", ".", " ", "switch"}]}], ":", " ", 
        RowBox[{"qubit", " ", "sent", " ", "into", " ", "the", " ", 
         RowBox[{"channel", ".", " ", "p"}], " ", "is", " ", "the", " ", 
         RowBox[{"probability", ".", " ", 
          RowBox[{"state", ":", " ", 
           RowBox[{"is", " ", "the", " ", 
            RowBox[{"input", "."}]}]}]}]}]}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Divide", "[", 
         RowBox[{
          RowBox[{"3", "p"}], ",", "4"}], "]"}]}], ")"}], "state"}], "+", 
     RowBox[{
      RowBox[{"Divide", "[", 
       RowBox[{"p", ",", "4"}], "]"}], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"single", "[", 
          RowBox[{"n", ",", "switch", ",", 
           RowBox[{"PauliMatrix", "[", "i", "]"}]}], "]"}], ".", "state", ".", 
         RowBox[{"single", "[", 
          RowBox[{"n", ",", "switch", ",", 
           RowBox[{"PauliMatrix", "[", "i", "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zMeas", "[", "0", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zMeas", "[", "1", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9195427527454324`*^9, 3.9195428023816895`*^9}, {
  3.91954284990275*^9, 3.9195428872227325`*^9}, {3.9195429835434403`*^9, 
  3.919543010654524*^9}, {3.919544514980333*^9, 3.919544729583177*^9}, {
  3.919546450647681*^9, 3.919546485854539*^9}, {3.919549719930683*^9, 
  3.9195497227919717`*^9}, {3.919549763363805*^9, 3.9195498619837213`*^9}, {
  3.919550191248863*^9, 3.9195502319370346`*^9}, {3.9195503442647295`*^9, 
  3.9195503479239397`*^9}, {3.919564690153268*^9, 3.9195646903812704`*^9}, {
  3.9195647981706448`*^9, 3.919564799027609*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d2ced899-cbe4-4892-9748-7d52c6fceb2c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partialTrace", "[", 
  RowBox[{
   RowBox[{"UnitVector", "[", 
    RowBox[{
     RowBox[{"2", "^", "8"}], ",", "1"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
     "2"}], "}"}], ",", 
   RowBox[{"{", "8", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.91954280620621*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"68c56d38-81ca-411e-ad33-1861cc532262"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9195428068151474`*^9, 3.9195428529972863`*^9, 3.9195449880196395`*^9, {
   3.919546238925804*^9, 3.9195462617781277`*^9}, {3.919546663828882*^9, 
   3.9195466893017893`*^9}, 3.9195474072881837`*^9, 3.919547589285863*^9, 
   3.919547725576516*^9, 3.919547966231511*^9, 3.919548194023895*^9, 
   3.9195486049286985`*^9, 3.919548693261874*^9, 3.9195487333691287`*^9, 
   3.9195489090100203`*^9, 3.9195489705338087`*^9, 3.9195496019923153`*^9, 
   3.919549725692212*^9, 3.919549968785195*^9, 3.919550148918852*^9, 
   3.919550298931785*^9, 3.9195504054848576`*^9, {3.9195504420668707`*^9, 
   3.919550462663086*^9}, 3.9195508452480183`*^9, 3.9195516694334974`*^9, 
   3.919553902222617*^9, 3.919555152366705*^9, 3.9195552140798855`*^9, 
   3.9195553869057207`*^9, 3.919556645249898*^9, 3.9195569868915052`*^9, 
   3.9195632311556587`*^9, 3.919563477820115*^9, 3.91956659603725*^9, 
   3.919566649332753*^9, 3.919566726429753*^9, {3.919567127721451*^9, 
   3.919567151374048*^9}, 3.9195674653425283`*^9, 3.9195997029058523`*^9, 
   3.919861977868623*^9, 3.9198620299505634`*^9, 3.9201418213395915`*^9, 
   3.9201418860992036`*^9, 3.9201419660458045`*^9, 3.9201420357914977`*^9, 
   3.920142191580303*^9, {3.9201422881779337`*^9, 3.920142311884334*^9}, 
   3.920142368772501*^9, 3.920143181924675*^9, {3.9201434759072056`*^9, 
   3.9201434892129517`*^9}, 3.920151285518431*^9, 3.920151925827304*^9, {
   3.9201600386538982`*^9, 3.9201600659473257`*^9}, 3.920315283626554*^9, 
   3.925560808087021*^9, 3.9255609653797054`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"fd147908-69d2-4ded-a993-e40b475f6632"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ket0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ket1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bra0", "=", 
   RowBox[{"Transpose", "[", "ket0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bra1", "=", 
   RowBox[{"Transpose", "[", "ket1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ketPlus", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], 
    RowBox[{"(", 
     RowBox[{"ket0", "+", "ket1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ketPhiPlus", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"ket0", ",", "ket0"}], "]"}], "+", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"ket1", ",", " ", "ket1"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoPhiPlus", "=", 
   RowBox[{"ketPhiPlus", ".", 
    RowBox[{"Transpose", "[", "ketPhiPlus", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoPlus", "=", 
   RowBox[{"ketPlus", ".", 
    RowBox[{"Transpose", "[", "ketPlus", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9195447598209567`*^9, 3.919544801220291*^9}, {
  3.9195448704177246`*^9, 3.9195448873766627`*^9}, {3.919544926803867*^9, 
  3.9195449271838813`*^9}, {3.9195451865234227`*^9, 3.9195451881557813`*^9}, {
  3.9195475808474092`*^9, 3.9195475861153135`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"861ce564-51fd-485b-b7f2-9ceab5258ddf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nqubits", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rho0", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"rhoPlus", ",", " ", "rhoPlus", ",", " ", "rhoPhiPlus"}], 
      "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"State", " ", "before", " ", "left", " ", "checks"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pcsLeftU", "=", 
     RowBox[{
      RowBox[{"cxGate", "[", 
       RowBox[{"nqubits", ",", "1", ",", "3"}], "]"}], ".", 
      RowBox[{"cxGate", "[", 
       RowBox[{"nqubits", ",", "2", ",", "4"}], "]"}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pcsRightU", "=", 
     RowBox[{"Transpose", "[", "pcsLeftU", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rho1", "=", 
     RowBox[{"pcsLeftU", ".", "rho0", ".", 
      RowBox[{"Transpose", "[", "pcsLeftU", "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"left", " ", "PCS", " ", "checks"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rho2", "=", "rho1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rho2", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"channel", "[", 
       RowBox[{"nqubits", ",", "1", ",", "p1", ",", "  ", "rho2"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rho2", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"channel", "[", 
       RowBox[{"nqubits", ",", "2", ",", "p2", ",", "  ", "rho2"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rho2", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"channel", "[", 
       RowBox[{"nqubits", ",", "3", ",", "p1", ",", "  ", "rho2"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rho2", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"channel", "[", 
       RowBox[{"nqubits", ",", "4", ",", "p2", ",", "  ", "rho2"}], "]"}], 
      "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"State", " ", "after", " ", "noise"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rho3", "=", 
     RowBox[{"pcsRightU", ".", "rho2", ".", 
      RowBox[{"Transpose", "[", "pcsRightU", "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"right", " ", "PCS", " ", 
     RowBox[{"checks", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Post", " ", "measurement", " ", "state", " ", "unormalized"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rho4", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"single", "[", 
        RowBox[{"nqubits", ",", " ", "1", ",", " ", "rhoPlus"}], "]"}], ".", 
       RowBox[{"single", "[", 
        RowBox[{"nqubits", ",", " ", "2", ",", " ", "rhoPlus"}], "]"}], ".", 
       "rho3", ".", 
       RowBox[{"single", "[", 
        RowBox[{"nqubits", ",", " ", "1", ",", " ", "rhoPlus"}], "]"}], ".", 
       RowBox[{"single", "[", 
        RowBox[{"nqubits", ",", " ", "2", ",", " ", "rhoPlus"}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"finalNormalizedSt", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"rho4", "/", 
       RowBox[{"Tr", "[", "rho4", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"noisyBellSt", "=", 
    RowBox[{"partialTrace", "[", 
     RowBox[{"finalNormalizedSt", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "]"}], 
    RowBox[{"(*", 
     RowBox[{"Final", " ", "normalized", " ", "state"}], 
     "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9195448298916817`*^9, 3.9195449504984665`*^9}, {
   3.919544992670236*^9, 3.91954514995444*^9}, {3.919545305669812*^9, 
   3.9195453265918093`*^9}, {3.9195454086089735`*^9, 3.919545694077916*^9}, {
   3.9195457298543863`*^9, 3.919545815468259*^9}, {3.9195462314667225`*^9, 
   3.919546267477878*^9}, {3.9195465007965593`*^9, 3.9195466875674295`*^9}, {
   3.919547455388364*^9, 3.919547559162751*^9}, {3.9195475995433846`*^9, 
   3.9195476011331296`*^9}, {3.9195476999443617`*^9, 
   3.9195477225356526`*^9}, {3.9195477663257465`*^9, 
   3.9195477855893035`*^9}, {3.919547899705392*^9, 3.9195479618223095`*^9}, {
   3.9195480532753663`*^9, 3.919548089673775*^9}, {3.919548127669301*^9, 
   3.919548158671977*^9}, {3.919548209840575*^9, 3.9195482212292247`*^9}, {
   3.91954859919903*^9, 3.9195486015417604`*^9}, {3.91954868949695*^9, 
   3.9195487228662324`*^9}, {3.9195488845690947`*^9, 
   3.9195489057059417`*^9}, {3.9195489453518586`*^9, 
   3.9195489684543734`*^9}, {3.9195490292932644`*^9, 3.919549036093069*^9}, {
   3.9195492126593356`*^9, 3.919549227971661*^9}, {3.919549535709731*^9, 
   3.919549599081105*^9}, {3.919549636305504*^9, 3.91954963717418*^9}, {
   3.919549715860591*^9, 3.9195497169197397`*^9}, {3.919549911068123*^9, 
   3.9195499355725083`*^9}, {3.9195500538468833`*^9, 3.919550138196274*^9}, {
   3.9195502448509097`*^9, 3.919550284600117*^9}, {3.9195503533783445`*^9, 
   3.919550390608474*^9}, {3.9195504382820005`*^9, 3.9195504602984066`*^9}, {
   3.9195505542936735`*^9, 3.9195506315179405`*^9}, {3.9195506795639067`*^9, 
   3.9195506802581325`*^9}, {3.9195508631781435`*^9, 3.919550872501998*^9}, {
   3.919555035180622*^9, 3.919555102348197*^9}, {3.919555135449751*^9, 
   3.9195551467888184`*^9}, {3.9195566350034194`*^9, 3.919556642067009*^9}, {
   3.919557326625424*^9, 3.919557331777627*^9}, 3.919565237625974*^9, {
   3.9255607888227224`*^9, 3.925560792834835*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"2ef2a9ff-6c33-46f9-bd82-8935d63a7840"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"8", "+", 
       RowBox[{"6", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}], "-", 
       RowBox[{"2", " ", "p1", " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], ")"}]}], 
       "+", 
       RowBox[{
        SuperscriptBox["p1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], ")"}]}]}], 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], ")"}]}]], 
     ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"p1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p2"}], ")"}]}], "-", "p2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p2"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], ")"}]}]]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}], "+", 
       RowBox[{"4", " ", "p2"}], "+", 
       RowBox[{"6", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1", " ", "p2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], 
        " ", 
        SuperscriptBox["p2", "2"]}]}], 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], ")"}]}]], 
     ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "p2"}], ")"}]}], "-", "p2"}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], 
         ")"}]}]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "p2"}], ")"}]}], "-", "p2"}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], 
         ")"}]}]]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}], "+", 
       RowBox[{"4", " ", "p2"}], "+", 
       RowBox[{"6", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1", " ", "p2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], 
        " ", 
        SuperscriptBox["p2", "2"]}]}], 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], ")"}]}]], 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"p1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p2"}], ")"}]}], "-", "p2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p2"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], ")"}]}]], 
     ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{"8", "+", 
       RowBox[{"6", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}], "-", 
       RowBox[{"2", " ", "p1", " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], ")"}]}], 
       "+", 
       RowBox[{
        SuperscriptBox["p1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], ")"}]}]}], 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], ")"}]}]]}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9195652384598494`*^9, 3.91956659615693*^9, 3.9195666498573804`*^9, 
   3.919566726551427*^9, {3.9195671282739735`*^9, 3.919567151500707*^9}, 
   3.9195674654512377`*^9, 3.9195997034101763`*^9, 3.919861978262995*^9, 
   3.9198620300582733`*^9, 3.9201418218229*^9, 3.9201418862158914`*^9, 
   3.9201419661485305`*^9, 3.9201420359022017`*^9, 3.920142191688015*^9, {
   3.920142288282655*^9, 3.9201423119990277`*^9}, 3.920142368879197*^9, 
   3.920143182398438*^9, {3.92014347601794*^9, 3.920143489317672*^9}, 
   3.9201512860400677`*^9, 3.9201519259370084`*^9, {3.9201600391343613`*^9, 
   3.9201600660560226`*^9}, 3.92031528403379*^9, 3.925560808571727*^9, 
   3.925560965825345*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"6adce922-939e-4a4b-a043-539f0b4905c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Tr", "[", "noisyBellSt", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9195467025034666`*^9, 3.919546748179021*^9}, {
  3.9195487783669553`*^9, 3.9195487793842306`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"a018e5af-a856-4048-bd0b-cd6d3ca98604"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.919547417660431*^9, 3.9195475902323294`*^9, 3.9195477276130667`*^9, 
   3.9195479664140224`*^9, 3.9195481942911777`*^9, {3.9195486234062586`*^9, 
   3.919548648527437*^9}, 3.9195487118351803`*^9, 3.9195487465568447`*^9, 
   3.919548780212019*^9, 3.919548915666212*^9, 3.91954897144637*^9, 
   3.9195497460218153`*^9, 3.9195504163727255`*^9, {3.919550449182832*^9, 
   3.919550469311298*^9}, 3.9195508502274694`*^9, 3.919551673685671*^9, 
   3.9195539061891146`*^9, 3.9195551526070585`*^9, 3.919555214397241*^9, 
   3.919555387023405*^9, 3.919556645730611*^9, 3.919556987402149*^9, 
   3.919563231622697*^9, 3.919563477951762*^9, 3.9195665961788716`*^9, 
   3.9195666498775787`*^9, 3.9195667265693784`*^9, {3.9195671282979093`*^9, 
   3.919567151524645*^9}, 3.91956746547318*^9, 3.919599703430623*^9, 
   3.919861978275925*^9, 3.919862030076227*^9, 3.9201418218428497`*^9, 
   3.9201418862338457`*^9, 3.9201419661714697`*^9, 3.9201420359201612`*^9, 
   3.9201421917059717`*^9, {3.9201422883016024`*^9, 3.92014231201698*^9}, 
   3.92014236890114*^9, 3.9201431824147744`*^9, {3.920143476042842*^9, 
   3.920143489337618*^9}, 3.920151286063553*^9, 3.9201519259589725`*^9, {
   3.9201600391513166`*^9, 3.920160066078962*^9}, 3.920315284065857*^9, 
   3.9255608086056395`*^9, 3.925560965862645*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"ba4f5ad0-ecfd-4a79-ac1e-952718100be5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fidelity", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"noisyBellSt", ".", "rhoPhiPlus"}], "]"}], "]"}], " ", 
  RowBox[{"(*", "Fidelity", "*)"}]}]], "Input",
 CellChangeTimes->{{3.9195487915716906`*^9, 3.9195488039386*^9}, {
  3.919550833093336*^9, 3.919550837744698*^9}, {3.9195509177546453`*^9, 
  3.9195509214137573`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"ec1c506a-2583-4b4b-bf7a-5a12048b21eb"],

Cell[BoxData[
 FractionBox[
  RowBox[{"16", "+", 
   RowBox[{"2", " ", "p1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "12"}], "+", 
      RowBox[{"5", " ", "p1"}]}], ")"}]}], "-", 
   RowBox[{"24", " ", "p2"}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"20", "-", 
      RowBox[{"9", " ", "p1"}]}], ")"}], " ", "p1", " ", "p2"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"10", "+", 
      RowBox[{"9", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], " ", 
    SuperscriptBox["p2", "2"]}]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{
  3.9195488051972322`*^9, 3.91954891569517*^9, 3.9195489714852667`*^9, 
   3.919549746066697*^9, 3.9195504166061025`*^9, {3.9195504492217283`*^9, 
   3.9195504693462043`*^9}, 3.9195508502344503`*^9, 3.919551673707402*^9, 
   3.919553906206009*^9, 3.9195551526358013`*^9, 3.919555214422495*^9, 
   3.9195553870313826`*^9, 3.9195566457984295`*^9, 3.9195569874670053`*^9, 
   3.91956323168789*^9, 3.9195634779776936`*^9, 3.919566596185852*^9, 
   3.9195666500252028`*^9, 3.9195667265943117`*^9, {3.9195671283866725`*^9, 
   3.919567151551572*^9}, 3.919567465482155*^9, 3.919599703493965*^9, 
   3.9198619783412995`*^9, 3.9198620300842047`*^9, 3.9201418219086714`*^9, 
   3.920141886242854*^9, 3.920141966179448*^9, 3.9201420359291306`*^9, 
   3.9201421917259145`*^9, {3.9201422883205867`*^9, 3.9201423120249577`*^9}, 
   3.920142368911111*^9, 3.9201431824815073`*^9, {3.920143476051817*^9, 
   3.9201434893475904`*^9}, 3.9201512861274157`*^9, 3.9201519259818892`*^9, {
   3.9201600392182255`*^9, 3.920160066096944*^9}, 3.9203152841349845`*^9, 
   3.925560808674483*^9, 3.925560966010727*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"6369a511-9cf8-41ed-aa74-baa1cfa46d32"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"postr", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", "rho4", "]"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"post", " ", "selection", " ", "rate"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.9195504976372013`*^9, 3.919550505243002*^9}, {
  3.919550840403926*^9, 3.9195508420938587`*^9}, {3.91955087637978*^9, 
  3.9195508819420705`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"05cc495f-0809-4f07-a59f-b8ac8f80da24"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{"2", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "p1"}], ")"}], " ", "p1"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"2", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "p2"}], ")"}], " ", "p2"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.919550509672331*^9, 3.919550850266474*^9, 3.9195516737148404`*^9, 
   3.91955390621299*^9, 3.9195551526632085`*^9, 3.919555214446892*^9, 
   3.9195553870473604`*^9, 3.9195566458263564`*^9, 3.9195569874921837`*^9, 
   3.9195632317087946`*^9, 3.9195634780016284`*^9, 3.919566596207796*^9, 
   3.919566650045456*^9, 3.91956672660229*^9, {3.919567128415595*^9, 
   3.9195671515595503`*^9}, 3.9195674654991164`*^9, 3.919599703510572*^9, 
   3.919861978357275*^9, 3.9198620301031537`*^9, 3.9201418219241276`*^9, 
   3.920141886261771*^9, 3.920141966196437*^9, 3.92014203594808*^9, 
   3.9201421917468576`*^9, {3.9201422883385043`*^9, 3.920142312040948*^9}, 
   3.9201423689290648`*^9, 3.920143182498334*^9, {3.9201434760747595`*^9, 
   3.9201434893665514`*^9}, 3.9201512861502624`*^9, 3.9201519259888697`*^9, {
   3.9201600392381477`*^9, 3.9201600661198535`*^9}, 3.9203152841694145`*^9, 
   3.9255608087134385`*^9, 3.9255609660496225`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"a3dbae78-3a4b-4636-90c4-ca47cb7a8e84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fidelity", "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.9255609185397515`*^9, 3.9255609313554764`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"e920c2fd-5117-47ef-bee6-9785350dc929"],

Cell["\<\
\\frac{(9 (\\text{p1}-2) \\text{p1}+10) \\text{p2}^2+2 (20-9 \\text{p1}) \
\\text{p1} \\text{p2}+2 \\text{p1} (5 \\text{p1}-12)-24 \\text{p2}+16}{4 \
((\\text{p1}-2) \\text{p1}+2) ((\\text{p2}-2)
   \\text{p2}+2)}\
\>", "Output",
 CellChangeTimes->{3.925560966086687*^9},
 CellLabel->
  "Out[36]//TeXForm=",ExpressionUUID->"41b3d30a-430f-4f13-81b3-b10fead573aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"postr", "//", "TeXForm"}]], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"78b3e26e-23d4-495d-bf04-d658f8513c6f"],

Cell["\<\
\\frac{1}{4} ((\\text{p1}-2) \\text{p1}+2) ((\\text{p2}-2) \\text{p2}+2)\
\>", "Output",
 CellChangeTimes->{3.925560966125955*^9},
 CellLabel->
  "Out[37]//TeXForm=",ExpressionUUID->"a053dad2-b094-4eb2-b7cf-450b179577f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Let", " ", "p1"}], "=", "p2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fidelityEqual", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"fidelity", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "->", "p"}], ",", 
        RowBox[{"p2", "->", "p"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"postrEqual", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"postr", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "->", "p"}], ",", 
        RowBox[{"p2", "->", "p"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.919550925359727*^9, 3.919550981292532*^9}, {
  3.919551029226468*^9, 3.9195510518356934`*^9}, {3.919551358301632*^9, 
  3.9195513599217005`*^9}, {3.919551396930185*^9, 3.919551649249771*^9}, {
  3.925560936980722*^9, 3.9255609486548953`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"9be26d42-3bab-4c92-9f09-20c972a59e83"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"4", "+", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "p"}], ")"}], " ", "p"}]}], ")"}], "2"], 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "p"}], ")"}], " ", "p"}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{
  3.919550982935957*^9, 3.9195510709146843`*^9, 3.919551361563177*^9, 
   3.9195514658434134`*^9, {3.9195515338514843`*^9, 3.919551548774414*^9}, 
   3.9195516135672727`*^9, 3.9195516737397623`*^9, 3.919553906232297*^9, 
   3.919555152694725*^9, 3.91955521447717*^9, 3.9195553870682845`*^9, 
   3.919556645855204*^9, 3.9195569875245*^9, 3.9195632317338624`*^9, 
   3.9195634780106063`*^9, 3.9195665962187643`*^9, 3.9195666500713863`*^9, 
   3.919566726621239*^9, {3.9195671284514985`*^9, 3.9195671515829425`*^9}, 
   3.9195674655210514`*^9, 3.919599703535505*^9, 3.9198619783811927`*^9, 
   3.9198620301231003`*^9, 3.920141821950042*^9, 3.920141886271742*^9, 
   3.9201419662153525`*^9, 3.9201420359560585`*^9, 3.9201421917558327`*^9, {
   3.920142288347481*^9, 3.9201423120508904`*^9}, 3.920142368949012*^9, 
   3.9201431825262585`*^9, {3.92014347608473*^9, 3.920143489390476*^9}, 
   3.9201512861781883`*^9, 3.920151926011809*^9, {3.920160039269065*^9, 
   3.920160066128829*^9}, 3.920315284202799*^9, 3.9255608088388805`*^9, 
   3.9255609661638527`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"643e1863-a96b-44bf-838b-b3515d5c9494"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "p"}], ")"}], " ", "p"}]}], ")"}], 
   "2"]}]], "Output",
 CellChangeTimes->{
  3.919550982935957*^9, 3.9195510709146843`*^9, 3.919551361563177*^9, 
   3.9195514658434134`*^9, {3.9195515338514843`*^9, 3.919551548774414*^9}, 
   3.9195516135672727`*^9, 3.9195516737397623`*^9, 3.919553906232297*^9, 
   3.919555152694725*^9, 3.91955521447717*^9, 3.9195553870682845`*^9, 
   3.919556645855204*^9, 3.9195569875245*^9, 3.9195632317338624`*^9, 
   3.9195634780106063`*^9, 3.9195665962187643`*^9, 3.9195666500713863`*^9, 
   3.919566726621239*^9, {3.9195671284514985`*^9, 3.9195671515829425`*^9}, 
   3.9195674655210514`*^9, 3.919599703535505*^9, 3.9198619783811927`*^9, 
   3.9198620301231003`*^9, 3.920141821950042*^9, 3.920141886271742*^9, 
   3.9201419662153525`*^9, 3.9201420359560585`*^9, 3.9201421917558327`*^9, {
   3.920142288347481*^9, 3.9201423120508904`*^9}, 3.920142368949012*^9, 
   3.9201431825262585`*^9, {3.92014347608473*^9, 3.920143489390476*^9}, 
   3.9201512861781883`*^9, 3.920151926011809*^9, {3.920160039269065*^9, 
   3.920160066128829*^9}, 3.920315284202799*^9, 3.9255608088388805`*^9, 
   3.9255609661706877`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"6528cf34-5cd8-4dbf-b5ea-e9d923e28c76"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Get", " ", "the", " ", "initial", " ", "fidelity"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"initialF", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Tr", "[", 
      RowBox[{
       RowBox[{"channel", "[", 
        RowBox[{"2", ",", "2", ",", "p", ",", 
         RowBox[{"channel", "[", 
          RowBox[{"2", ",", "1", ",", "p", ",", "rhoPhiPlus"}], "]"}]}], 
        "]"}], ".", "rhoPhiPlus"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"F", "==", "initialF"}], ",", "p"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9195670858038197`*^9, 3.9195670972502337`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"91f6967f-4a47-4056-b4cb-5324118e81ea"],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{
   FractionBox["3", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", "p"}], ")"}], " ", "p"}]}]], "Output",
 CellChangeTimes->{
  3.91956706584118*^9, 3.9195670983357334`*^9, {3.919567128482417*^9, 
   3.919567151611998*^9}, 3.9195674655429945`*^9, 3.9195997035574884`*^9, 
   3.919861978399884*^9, 3.919862030148034*^9, 3.920141821968973*^9, 
   3.92014188629568*^9, 3.9201419662263227`*^9, 3.920142035977002*^9, 
   3.92014219177977*^9, {3.920142288369424*^9, 3.9201423120738277`*^9}, 
   3.920142368972947*^9, 3.920143182550204*^9, {3.9201434761106925`*^9, 
   3.9201434894144473`*^9}, 3.9201512862093587`*^9, 3.920151926023776*^9, {
   3.9201600392949953`*^9, 3.920160066153002*^9}, 3.9203152842421255`*^9, 
   3.9255608088812003`*^9, 3.925560966207114*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"5fa4e58a-9828-4c83-a89e-22837a5b3f42"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"3", "-", 
        RowBox[{
         SqrtBox["3"], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"4", " ", "F"}]}]]}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{
         SqrtBox["3"], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"4", " ", "F"}]}]]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.91956706584118*^9, 3.9195670983357334`*^9, {3.919567128482417*^9, 
   3.919567151611998*^9}, 3.9195674655429945`*^9, 3.9195997035574884`*^9, 
   3.919861978399884*^9, 3.919862030148034*^9, 3.920141821968973*^9, 
   3.92014188629568*^9, 3.9201419662263227`*^9, 3.920142035977002*^9, 
   3.92014219177977*^9, {3.920142288369424*^9, 3.9201423120738277`*^9}, 
   3.920142368972947*^9, 3.920143182550204*^9, {3.9201434761106925`*^9, 
   3.9201434894144473`*^9}, 3.9201512862093587`*^9, 3.920151926023776*^9, {
   3.9201600392949953`*^9, 3.920160066153002*^9}, 3.9203152842421255`*^9, 
   3.9255608088812003`*^9, 3.9255609662101154`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"12719af9-edfb-4c70-a2f2-57d349bb7456"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"In", " ", "terms", " ", "of", " ", "initial", " ", "F"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fidelityInitialF", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"fidelityEqual", "/.", 
      RowBox[{"p", "->", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{
           SqrtBox["3"], " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", "F"}]}]]}]}], ")"}]}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"postrInitialF", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"postrEqual", "/.", 
      RowBox[{"p", "->", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{
           SqrtBox["3"], " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", "F"}]}]]}]}], ")"}]}]}]}], 
     RowBox[{"(*", 
      RowBox[{"4", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Sqrt", "[", "F", "]"}]}], ")"}], "/", "3"}]}], "*)"}], 
     "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.919551654160003*^9, 3.9195516661988125`*^9}, {
  3.919566562037271*^9, 3.919566589487777*^9}, {3.9195670542905803`*^9, 
  3.919567054636386*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"c78068d1-473b-4552-94f2-093edddb01a3"],

Cell[BoxData[
 FractionBox[
  RowBox[{"9", " ", 
   SuperscriptBox["F", "2"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "F"}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{
  3.9195516737625856`*^9, 3.919553906266206*^9, 3.919555152728634*^9, 
   3.9195552145090895`*^9, 3.919555387105187*^9, 3.9195566458928795`*^9, 
   3.919556987559224*^9, 3.9195632317667837`*^9, 3.9195634780445485`*^9, 
   3.91956659624669*^9, 3.9195666500965896`*^9, 3.9195667266441774`*^9, {
   3.9195671285921216`*^9, 3.9195671516423445`*^9}, 3.919567465565234*^9, 
   3.919599703583419*^9, 3.919861978419963*^9, 3.9198620301721582`*^9, 
   3.9201418219929085`*^9, 3.9201418863172135`*^9, 3.920141966248674*^9, 
   3.920142036000039*^9, 3.9201421918012943`*^9, {3.9201422883955803`*^9, 
   3.9201423120964994`*^9}, 3.9201423689947653`*^9, 3.9201431825721045`*^9, {
   3.9201434761355963`*^9, 3.920143489440353*^9}, 3.920151286247073*^9, 
   3.920151926065387*^9, {3.920160039319929*^9, 3.920160066178965*^9}, 
   3.92031528428222*^9, 3.9255608089200516`*^9, 3.925560966245979*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"a7ff3d03-4722-4d74-a2c8-e50927cd7461"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "9"], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "F"}]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.9195516737625856`*^9, 3.919553906266206*^9, 3.919555152728634*^9, 
   3.9195552145090895`*^9, 3.919555387105187*^9, 3.9195566458928795`*^9, 
   3.919556987559224*^9, 3.9195632317667837`*^9, 3.9195634780445485`*^9, 
   3.91956659624669*^9, 3.9195666500965896`*^9, 3.9195667266441774`*^9, {
   3.9195671285921216`*^9, 3.9195671516423445`*^9}, 3.919567465565234*^9, 
   3.919599703583419*^9, 3.919861978419963*^9, 3.9198620301721582`*^9, 
   3.9201418219929085`*^9, 3.9201418863172135`*^9, 3.920141966248674*^9, 
   3.920142036000039*^9, 3.9201421918012943`*^9, {3.9201422883955803`*^9, 
   3.9201423120964994`*^9}, 3.9201423689947653`*^9, 3.9201431825721045`*^9, {
   3.9201434761355963`*^9, 3.920143489440353*^9}, 3.920151286247073*^9, 
   3.920151926065387*^9, {3.920160039319929*^9, 3.920160066178965*^9}, 
   3.92031528428222*^9, 3.9255608089200516`*^9, 3.9255609662499676`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"850f181e-3d75-4382-b03f-669b684f4f57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fidelityInitialF", ",", " ", "F"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"F", ",", 
     RowBox[{"1", "/", "4"}], ",", "1"}], "}"}], ",", " ", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<PCS X\>\"", ",", " ", "\"\<F'=F\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Right", ",", " ", "Center"}], "}"}]}], "]"}]}], ",", " ", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<F\>\"", ",", " ", "\"\<F'\>\""}], "}"}]}], ",", " ", 
   RowBox[{"AspectRatio", "->", "1"}], ",", " ", 
   RowBox[{"PlotLabel", "->", "\"\<Final vs Initial Fidelity\>\""}], ",", " ", 
   RowBox[{"Ticks", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"1", "/", "4"}], ",", "1", ",", "0.25"}], "]"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"1", "/", "4"}], ",", "1", ",", "0.25"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9195517965648327`*^9, 3.9195518095785384`*^9}, {
  3.919551842555027*^9, 3.919551847381749*^9}, {3.9195521870732183`*^9, 
  3.919552188309332*^9}, {3.9195534150819407`*^9, 3.9195534909204426`*^9}, {
  3.919553525710683*^9, 3.919553539092626*^9}, {3.9195535760792236`*^9, 
  3.919553636136962*^9}, {3.919553681854323*^9, 3.919553752990218*^9}, {
  3.9195538968306828`*^9, 3.91955389857661*^9}, {3.919555382995353*^9, 
  3.9195553841206245`*^9}, {3.9195674585530396`*^9, 3.919567459679948*^9}, {
  3.91959952791327*^9, 3.9195995284214544`*^9}, {3.9196000242464004`*^9, 
  3.9196000251428537`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"ab7fb2a6-413e-47cb-b87c-617eae9322a9"],

Cell[BoxData[
 TagBox[
  GraphicsBox[{{{{}, {}, 
      TagBox[
       {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
        Opacity[1.], LineBox[CompressedData["
1:eJwVzHk41HkAx/FZNpMrhXoY5QpFbVSrRPVJtcLD6nAly8pQWZvUIyHpUD0V
1pZ2N1tbVk2OqU0sU8s2YYXN42ca1+SYGQZzfteRKzU7/fF5Xv+8n4/NwYS9
MVo0Gs1fs0/e2Z2wkEajwONKF39S8bmku16bQrA5P1lnHoXNz8IKr9ApGKly
ug30KAhsvDaYGFFwucb51dyUwpLxpeEOlhR0ssoXr19JIfdm80O/zRRsTY5U
xeymcF5gj1unKLjnNh9rvEchltnz/bpRCgu4bUapnm2Isk7OfTzZhgZ3HWPX
OzzInNlPOmQ8bAiQL8oUvoHbH+y/vhS8gf1eluSxRTs4HYJrPb18/Lbmqxjj
hA407Cnc70K1QzxdwzIr7oRO0i1FS0cH/sk38jGf7YL+/ANxBV2d4MTItQI8
BbirqpRYN3VhzXfCKcOEt2Cmb3OQtXSjyHbMeNfTHnAimczIlwJ0HvWYsu/p
RVvZvmy9J28R1+0RFD/XBwv2sTS1pnMO7HNKNhNiYmbFoXv3e6G1WlAWzhJC
TQzMrpX0YaPVRoZqiwitQTXlpaX96G9+F5hIifAzPdOh2l8IK9OUJN0QMSLc
uEGvWoXYani6vWlIDOX1pgsrfUQQOl6V9ccN4ObLI3mPX4swyKg7XD01AKui
hPxWfzGSOdKltRmDOMbZfterQQwfMUdUODcIwW32JbH3AGxZdd695yTQLx2I
59cOoL0yJ89jTgKrxLPeUe6DqFl+OTTw+BD89Ct0TKoHMRbfMxH13xC2tVbU
MVwlWCtxeMFgDsP/kF/0Lo4E6gxuekr/MDZX+Uwv2DSEelqmMCt4BOMuplmr
y4bge/DKVl7dCGrPJGklrB+Gw7yEshg3KfZPFibTHw1j1PKL+sRCKXj2bmJ3
uxHohgRyX+jJwHSMdr7xYAQRt7qMDFJkqAk+kOZpKYWHrJTv1yeDc6is2LRA
Cv0FJSW+vnIcvuDVucVC0716czzjkRyZsfNnP7shw8lvw5o9DRV4tixKLTOV
g8l87ZJ6QoE/P17SdsqRY8/OD5fC2xRoLt8hy16kgJ14OjTVVYmX1rENWdcV
WOrOc3H8SYmzVUEFIj0llin7V46qlAi17Yk4kK2E4US0qNxfhalKZ4tVdBW+
/j3Wpum+Cqe0pa9vnlEhw4AeJJ5WwdhuU5Q9jSCeZd3yfC/BiaPBE3opBC+K
mtd4PyAw28BsdEgjsOOOa1eyCKo/JN7enk6gpy3iLi8i0MnO3pl6jiA/Z+HY
xxKNpfV50isEST7qtRVPCGpH1rk25hNkm085MqoJjKONTl7UuE9ip8vnEVQ5
LfMt+JugMJsItvIJwsecLGu4BGG2tXnF7QSsc14NE/UEHacvc890EbjfS1/C
bNH89rVMr+gjONgrr9yusUDLWpUkJaA/mLkaISTQqojx7JcRsOPpkalighk5
/7S3gmDyvS396RABL8CNzSAEVxlhITYapen+ypoJAmfxoVVbRgl058zPO0wS
8IuT1KHjBLuqrdU5UwSWm358mKsx4htJWeQsQR3tbhp7hkAW93D41XuCw43s
gEaNoybseS4fCAxyny8f1Bh49J3+Lx8JykIap9Rqgn9/uDj7yf8BNaWG3Q==

         "]]},
       Annotation[#, "Charting`Private`Tag$3937#1"]& ], 
      TagBox[
       {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], 
        Opacity[1.], LineBox[CompressedData["
1:eJxFxXss1AEcAPBfNGdYCjMj5xFX0XamGMZI7aK59Zq3seNCTR1rIjeWyOZx
7fJYYxo3Sbpf8opTp3ntOsYO6XAdcR7x85oYyXTVH32/f3z2sYvlXb+pQxAE
+69/P7/KO0oQw77/Xz28MNmni3t3RNTk03CVHcvd1Bg33zoexaDjwrKBuiBv
/JHK0bc8HY/nqu+4buIc2zRhw84ITDHJRiU1Cnu8JT+cU32GJUpVoXpqDJZd
qwl3Gf4C66WWrw4plbChfuRt0cQ4XLXetmDbPwFzM/0Y1NAkLInhcmO6VfBI
0w2BQeNX2IpM5mub1fD23smE6hdTsHbDyKLw9TSsCO5sEYu/wc9ouQwpewaO
9ugK/qTA14r7c04FzsJl3bdKGwZxm1e8CgVbAydL/KtYMlxVSeZpAuZgQ/Fc
0lgPbpPyMIDjNQ8HGbbqmUpxP0Vrr6XbAsxOCIq7JMG92wN/HvFchLdczIrO
NOE9Wak6vLPf4fCdmjTaG3zU0UPj5bAEc0/HMUtq8c6QSP55+jLMDKPqzUR4
Yg5r3MeKgnPj9X8dKsE7rDlaymwFfvc7T9fpCT7QcoESHFuFu23jZUXF+MP2
YNGswRocZq+OjhTgu21MK2faOpyuuzxYloWbOHhyHIkN+N7dkG2DB7iFO1fO
4OPSg5RK/0xcTyC4mJGNV4j7Spfz8Z4lVzd5BW4SZ3z/sRRvd7K+LPqIR/1w
ond24S+zWbLtPtyrOtOcO4THTq20+U/jtNq9gugZnEyixWRo8J19e1rzIl5g
GRFqt4EzNQnOPpv4WH2qNmwLp3s+rRPu4r1EFZ/cwxPl5BX5Pm4kfH9i/gBv
CpXvarX4H7eCgIU=
         "]]},
       Annotation[#, "Charting`Private`Tag$3937#2"]& ]}, {}}, InsetBox[
     TemplateBox[{"\"PCS X\"", "\"F'=F\""},
      "LineLegend",
      DisplayFunction->(FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ),
      Editable->True,
      InterpretationFunction:>(RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& )], 
     Scaled[{0.99, 0.5}], ImageScaled[{1, 0.5}],
     BaseStyle->{FontSize -> Larger},
     FormatType->StandardForm]},
   AspectRatio->1,
   Axes->{True, True},
   AxesLabel->{
     FormBox[
      TagBox["\"F\"", HoldForm], TraditionalForm], 
     FormBox[
      TagBox["\"F'\"", HoldForm], TraditionalForm]},
   AxesOrigin->{0.25000000000000056`, 0.250000015306123},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   Method->{
    "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> None, 
     "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& )}},
   PlotLabel->FormBox["\"Final vs Initial Fidelity\"", TraditionalForm],
   PlotRange->NCache[{{
       Rational[1, 4], 1}, {0.2500000153061224, 0.9999999897959183}}, {{
      0.25, 1}, {0.2500000153061224, 0.9999999897959183}}],
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.05], 
      Scaled[0.05]}},
   Ticks->{{{0.25, 
       FormBox["0.25`", TraditionalForm]}, {0.5, 
       FormBox["0.5`", TraditionalForm]}, {0.75, 
       FormBox["0.75`", TraditionalForm]}, {1., 
       FormBox["1.`", TraditionalForm]}}, {{0.25, 
       FormBox["0.25`", TraditionalForm]}, {0.5, 
       FormBox["0.5`", TraditionalForm]}, {0.75, 
       FormBox["0.75`", TraditionalForm]}, {1., 
       FormBox["1.`", TraditionalForm]}}}],
  InterpretTemplate[Legended[
    Graphics[{{{{}, {}, 
        Annotation[{
          Directive[
           Opacity[1.], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]], 
          Line[CompressedData["
1:eJwVzHk41HkAx/FZNpMrhXoY5QpFbVSrRPVJtcLD6nAly8pQWZvUIyHpUD0V
1pZ2N1tbVk2OqU0sU8s2YYXN42ca1+SYGQZzfteRKzU7/fF5Xv+8n4/NwYS9
MVo0Gs1fs0/e2Z2wkEajwONKF39S8bmku16bQrA5P1lnHoXNz8IKr9ApGKly
ug30KAhsvDaYGFFwucb51dyUwpLxpeEOlhR0ssoXr19JIfdm80O/zRRsTY5U
xeymcF5gj1unKLjnNh9rvEchltnz/bpRCgu4bUapnm2Isk7OfTzZhgZ3HWPX
OzzInNlPOmQ8bAiQL8oUvoHbH+y/vhS8gf1eluSxRTs4HYJrPb18/Lbmqxjj
hA407Cnc70K1QzxdwzIr7oRO0i1FS0cH/sk38jGf7YL+/ANxBV2d4MTItQI8
BbirqpRYN3VhzXfCKcOEt2Cmb3OQtXSjyHbMeNfTHnAimczIlwJ0HvWYsu/p
RVvZvmy9J28R1+0RFD/XBwv2sTS1pnMO7HNKNhNiYmbFoXv3e6G1WlAWzhJC
TQzMrpX0YaPVRoZqiwitQTXlpaX96G9+F5hIifAzPdOh2l8IK9OUJN0QMSLc
uEGvWoXYani6vWlIDOX1pgsrfUQQOl6V9ccN4ObLI3mPX4swyKg7XD01AKui
hPxWfzGSOdKltRmDOMbZfterQQwfMUdUODcIwW32JbH3AGxZdd695yTQLx2I
59cOoL0yJ89jTgKrxLPeUe6DqFl+OTTw+BD89Ct0TKoHMRbfMxH13xC2tVbU
MVwlWCtxeMFgDsP/kF/0Lo4E6gxuekr/MDZX+Uwv2DSEelqmMCt4BOMuplmr
y4bge/DKVl7dCGrPJGklrB+Gw7yEshg3KfZPFibTHw1j1PKL+sRCKXj2bmJ3
uxHohgRyX+jJwHSMdr7xYAQRt7qMDFJkqAk+kOZpKYWHrJTv1yeDc6is2LRA
Cv0FJSW+vnIcvuDVucVC0716czzjkRyZsfNnP7shw8lvw5o9DRV4tixKLTOV
g8l87ZJ6QoE/P17SdsqRY8/OD5fC2xRoLt8hy16kgJ14OjTVVYmX1rENWdcV
WOrOc3H8SYmzVUEFIj0llin7V46qlAi17Yk4kK2E4US0qNxfhalKZ4tVdBW+
/j3Wpum+Cqe0pa9vnlEhw4AeJJ5WwdhuU5Q9jSCeZd3yfC/BiaPBE3opBC+K
mtd4PyAw28BsdEgjsOOOa1eyCKo/JN7enk6gpy3iLi8i0MnO3pl6jiA/Z+HY
xxKNpfV50isEST7qtRVPCGpH1rk25hNkm085MqoJjKONTl7UuE9ip8vnEVQ5
LfMt+JugMJsItvIJwsecLGu4BGG2tXnF7QSsc14NE/UEHacvc890EbjfS1/C
bNH89rVMr+gjONgrr9yusUDLWpUkJaA/mLkaISTQqojx7JcRsOPpkalighk5
/7S3gmDyvS396RABL8CNzSAEVxlhITYapen+ypoJAmfxoVVbRgl058zPO0wS
8IuT1KHjBLuqrdU5UwSWm358mKsx4htJWeQsQR3tbhp7hkAW93D41XuCw43s
gEaNoybseS4fCAxyny8f1Bh49J3+Lx8JykIap9Rqgn9/uDj7yf8BNaWG3Q==

           "]]}, "Charting`Private`Tag$3937#1"], 
        Annotation[{
          Directive[
           Opacity[1.], 
           RGBColor[0.880722, 0.611041, 0.142051], 
           AbsoluteThickness[1.6]], 
          Line[CompressedData["
1:eJxFxXss1AEcAPBfNGdYCjMj5xFX0XamGMZI7aK59Zq3seNCTR1rIjeWyOZx
7fJYYxo3Sbpf8opTp3ntOsYO6XAdcR7x85oYyXTVH32/f3z2sYvlXb+pQxAE
+69/P7/KO0oQw77/Xz28MNmni3t3RNTk03CVHcvd1Bg33zoexaDjwrKBuiBv
/JHK0bc8HY/nqu+4buIc2zRhw84ITDHJRiU1Cnu8JT+cU32GJUpVoXpqDJZd
qwl3Gf4C66WWrw4plbChfuRt0cQ4XLXetmDbPwFzM/0Y1NAkLInhcmO6VfBI
0w2BQeNX2IpM5mub1fD23smE6hdTsHbDyKLw9TSsCO5sEYu/wc9ouQwpewaO
9ugK/qTA14r7c04FzsJl3bdKGwZxm1e8CgVbAydL/KtYMlxVSeZpAuZgQ/Fc
0lgPbpPyMIDjNQ8HGbbqmUpxP0Vrr6XbAsxOCIq7JMG92wN/HvFchLdczIrO
NOE9Wak6vLPf4fCdmjTaG3zU0UPj5bAEc0/HMUtq8c6QSP55+jLMDKPqzUR4
Yg5r3MeKgnPj9X8dKsE7rDlaymwFfvc7T9fpCT7QcoESHFuFu23jZUXF+MP2
YNGswRocZq+OjhTgu21MK2faOpyuuzxYloWbOHhyHIkN+N7dkG2DB7iFO1fO
4OPSg5RK/0xcTyC4mJGNV4j7Spfz8Z4lVzd5BW4SZ3z/sRRvd7K+LPqIR/1w
ond24S+zWbLtPtyrOtOcO4THTq20+U/jtNq9gugZnEyixWRo8J19e1rzIl5g
GRFqt4EzNQnOPpv4WH2qNmwLp3s+rRPu4r1EFZ/cwxPl5BX5Pm4kfH9i/gBv
CpXvarX4H7eCgIU=
           "]]}, "Charting`Private`Tag$3937#2"]}}, {}}, {
     DisplayFunction -> Identity, 
      Ticks -> {{0.25, 0.5, 0.75, 1.}, {0.25, 0.5, 0.75, 1.}}, 
      AxesOrigin -> {0.25000000000000056`, 0.250000015306123}, 
      FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
      GridLines -> {None, None}, DisplayFunction -> Identity, 
      PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}}, PlotRangeClipping -> True, ImagePadding -> All, 
      DisplayFunction -> Identity, AspectRatio -> 1, Axes -> {True, True}, 
      AxesLabel -> {
        HoldForm["F"], 
        HoldForm["F'"]}, AxesOrigin -> {0.25, 0.2500000153061224}, 
      DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
      FrameLabel -> {{None, None}, {None, None}}, 
      FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
      GridLines -> {None, None}, GridLinesStyle -> Directive[
        GrayLevel[0.5, 0.4]], 
      Method -> {
       "DefaultBoundaryStyle" -> Automatic, 
        "DefaultGraphicsInteraction" -> {
         "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
          "Effects" -> {
           "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
            "Droplines" -> {
             "freeformCursorMode" -> True, 
              "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
        "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> 
        None, "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}}, PlotLabel -> "Final vs Initial Fidelity", 
      PlotRange -> {{
         Rational[1, 4], 1}, {0.2500000153061224, 0.9999999897959183}}, 
      PlotRangeClipping -> True, PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.02], 
         Scaled[0.02]}}, 
      Ticks -> {{0.25, 0.5, 0.75, 1.}, {0.25, 0.5, 0.75, 1.}}}], 
    Placed[
     Unevaluated[
      LineLegend[{
        Directive[
         Opacity[1.], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        Directive[
         Opacity[1.], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]]}, {"PCS X", "F'=F"}, LegendMarkers -> None, 
       LabelStyle -> {}, LegendLayout -> "Column"]], {Right, Center}, 
     Identity]]& ],
  AutoDelete->True,
  Editable->True,
  SelectWithContents->False,
  Selectable->True]], "Output",
 CellChangeTimes->{
  3.9195518109892035`*^9, 3.9195518492338276`*^9, 3.919552189050973*^9, {
   3.9195534748677254`*^9, 3.9195534921098523`*^9}, {3.919553528836567*^9, 
   3.919553546522479*^9}, {3.91955358743532*^9, 3.9195536366551476`*^9}, {
   3.919553720834543*^9, 3.9195537540360017`*^9}, 3.9195539063442583`*^9, 
   3.919555152802129*^9, 3.9195552150915527`*^9, {3.919555384661987*^9, 
   3.9195553871691217`*^9}, 3.9195566459670024`*^9, 3.919556987837286*^9, 
   3.919563231834365*^9, 3.9195634781103945`*^9, 3.919566596310443*^9, 
   3.919566650448386*^9, 3.919566726704017*^9, {3.91956712897011*^9, 
   3.9195671517118454`*^9}, 3.919567465627905*^9, 3.9195997038581047`*^9, 
   3.919600027902856*^9, 3.9198619784785314`*^9, 3.919862030234262*^9, 
   3.920141822272334*^9, 3.9201418863825574`*^9, 3.92014196630995*^9, 
   3.9201420360641108`*^9, 3.9201421918690786`*^9, {3.9201422884634295`*^9, 
   3.920142312160275*^9}, 3.9201423690644674`*^9, 3.9201431828582973`*^9, {
   3.9201434761964617`*^9, 3.9201434895101643`*^9}, 3.9201512863146596`*^9, 
   3.9201519261319947`*^9, {3.9201600396058445`*^9, 3.9201600662429123`*^9}, 
   3.9203152843614397`*^9, 3.9255608092625413`*^9, 3.9255609665849085`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"e51ec832-5b96-4f9b-981d-b111eb7e762a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pcsFid", "[", "F_", "]"}], ":=", 
  FractionBox[
   RowBox[{"9", " ", 
    SuperscriptBox["F", "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "F"}]}], ")"}], "2"]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bbpFid", "[", "F_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"F", "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "F"}], ")"}], "/", "3"}], ")"}], "^", "2"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"F", "^", "2"}], "+", 
      RowBox[{"2", "F", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "F"}], ")"}], "/", "3"}]}], "+", 
      RowBox[{"5", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "F"}], ")"}], "/", "3"}], ")"}], ")"}], "^", 
        "2"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pcsFid", "[", "F", "]"}], ",", " ", 
     RowBox[{"bbpFid", "[", "F", "]"}], ",", " ", "F"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"F", ",", 
     RowBox[{"1", "/", "4"}], ",", "1"}], "}"}], ",", "  ", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<PCS X\>\"", ",", " ", "\"\<1 Round BBPSSW\>\"", ",", " ", 
        "\"\<F'=F\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{".8", ",", " ", ".4"}], "}"}]}], "]"}]}], ",", " ", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<F\>\"", ",", " ", "\"\<F'\>\""}], "}"}]}], ",", " ", 
   RowBox[{"AspectRatio", "->", "1"}], ",", " ", 
   RowBox[{"PlotLabel", "->", "\"\<Final vs Initial Fidelity\>\""}], ",", " ", 
   RowBox[{"Ticks", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"1", "/", "4"}], ",", "1", ",", "0.25"}], "]"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"1", "/", "4"}], ",", "1", ",", "0.25"}], "]"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.919552569568323*^9, 3.9195526519112673`*^9}, {
  3.9195537731945395`*^9, 3.9195538372384825`*^9}, {3.919553869689624*^9, 
  3.919553893599165*^9}, {3.9195553711227245`*^9, 3.9195553738913965`*^9}, {
  3.919566716639925*^9, 3.9195667194618173`*^9}, {3.919567462946529*^9, 
  3.919567463517853*^9}, {3.919599534304056*^9, 3.919599534841812*^9}, {
  3.9201418337959843`*^9, 3.920141834284483*^9}, {3.9201418730168443`*^9, 
  3.92014188115582*^9}, {3.9201419543260756`*^9, 3.920141963615402*^9}, {
  3.920142031936945*^9, 3.9201420799130354`*^9}, {3.920142247652929*^9, 
  3.9201423652399487`*^9}, {3.920142435259597*^9, 3.920142440184317*^9}, {
  3.92014348559385*^9, 3.9201434872149196`*^9}, {3.9201600120624266`*^9, 
  3.9201600632401395`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"41b44690-48f2-424f-b9be-ae24e866654d"],

Cell[BoxData[
 TagBox[
  GraphicsBox[{{{{}, {}, 
      TagBox[
       {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
        Opacity[1.], LineBox[CompressedData["
1:eJwVzHk41HkAx/FZNpMrhXoY5QpFbVSrRPVJtcLD6nAly8pQWZvUIyHpUD0V
1pZ2N1tbVk2OqU0sU8s2YYXN42ca1+SYGQZzfteRKzU7/fF5Xv+8n4/NwYS9
MVo0Gs1fs0/e2Z2wkEajwONKF39S8bmku16bQrA5P1lnHoXNz8IKr9ApGKly
ug30KAhsvDaYGFFwucb51dyUwpLxpeEOlhR0ssoXr19JIfdm80O/zRRsTY5U
xeymcF5gj1unKLjnNh9rvEchltnz/bpRCgu4bUapnm2Isk7OfTzZhgZ3HWPX
OzzInNlPOmQ8bAiQL8oUvoHbH+y/vhS8gf1eluSxRTs4HYJrPb18/Lbmqxjj
hA407Cnc70K1QzxdwzIr7oRO0i1FS0cH/sk38jGf7YL+/ANxBV2d4MTItQI8
BbirqpRYN3VhzXfCKcOEt2Cmb3OQtXSjyHbMeNfTHnAimczIlwJ0HvWYsu/p
RVvZvmy9J28R1+0RFD/XBwv2sTS1pnMO7HNKNhNiYmbFoXv3e6G1WlAWzhJC
TQzMrpX0YaPVRoZqiwitQTXlpaX96G9+F5hIifAzPdOh2l8IK9OUJN0QMSLc
uEGvWoXYani6vWlIDOX1pgsrfUQQOl6V9ccN4ObLI3mPX4swyKg7XD01AKui
hPxWfzGSOdKltRmDOMbZfterQQwfMUdUODcIwW32JbH3AGxZdd695yTQLx2I
59cOoL0yJ89jTgKrxLPeUe6DqFl+OTTw+BD89Ct0TKoHMRbfMxH13xC2tVbU
MVwlWCtxeMFgDsP/kF/0Lo4E6gxuekr/MDZX+Uwv2DSEelqmMCt4BOMuplmr
y4bge/DKVl7dCGrPJGklrB+Gw7yEshg3KfZPFibTHw1j1PKL+sRCKXj2bmJ3
uxHohgRyX+jJwHSMdr7xYAQRt7qMDFJkqAk+kOZpKYWHrJTv1yeDc6is2LRA
Cv0FJSW+vnIcvuDVucVC0716czzjkRyZsfNnP7shw8lvw5o9DRV4tixKLTOV
g8l87ZJ6QoE/P17SdsqRY8/OD5fC2xRoLt8hy16kgJ14OjTVVYmX1rENWdcV
WOrOc3H8SYmzVUEFIj0llin7V46qlAi17Yk4kK2E4US0qNxfhalKZ4tVdBW+
/j3Wpum+Cqe0pa9vnlEhw4AeJJ5WwdhuU5Q9jSCeZd3yfC/BiaPBE3opBC+K
mtd4PyAw28BsdEgjsOOOa1eyCKo/JN7enk6gpy3iLi8i0MnO3pl6jiA/Z+HY
xxKNpfV50isEST7qtRVPCGpH1rk25hNkm085MqoJjKONTl7UuE9ip8vnEVQ5
LfMt+JugMJsItvIJwsecLGu4BGG2tXnF7QSsc14NE/UEHacvc890EbjfS1/C
bNH89rVMr+gjONgrr9yusUDLWpUkJaA/mLkaISTQqojx7JcRsOPpkalighk5
/7S3gmDyvS396RABL8CNzSAEVxlhITYapen+ypoJAmfxoVVbRgl058zPO0wS
8IuT1KHjBLuqrdU5UwSWm358mKsx4htJWeQsQR3tbhp7hkAW93D41XuCw43s
gEaNoybseS4fCAxyny8f1Bh49J3+Lx8JykIap9Rqgn9/uDj7yf8BNaWG3Q==

         "]]},
       Annotation[#, "Charting`Private`Tag$4250#1"]& ], 
      TagBox[
       {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], 
        Opacity[1.], LineBox[CompressedData["
1:eJwVzn0w1HkcB/Atd9bRk4erkIeVKJnW6XTW6N5So7rhKp2IUlikKQ9zs9eD
y1XUjGrLVaazV4eQyp7Lw4nQeOgkQ/vDtuy2tHYtu2t3v5WNqOxtf3zmNe/3
P+8PIz4tPHE+jUYLM91nb+1MW0KjUUiXGSw/q/1CKX5iRsHzqK4oez6FwIbo
klw6hdUWz2kWX1KQMEI22C6mUDkw7mRrSWHp5Ip9Hs4UeEVDXb52FPLyu8pD
AymUeRdKbqymcFayCgXHKdA1L93f76KQxJYe9X1DwaElUGBVTiHO9Vhe5VQv
GNZRriSlFxom/4FI04cCNmc0xrsP/v/wG7+V9EN4m2HvMtWHepHkonRIiLqd
omqhtB8du0r2+lAvsCtjt1PhYyHMOQXaHpEIQ5HGde+bX8DKIuZw8eAA0u19
I4raRCjU1yldnw3ip02NxermAbBPBXloesTYsCYpOUM0iPoDbPaBVgkc8q1P
2yvE6K3azbV88BJubjaPrF9L4MhPzzRWS1GqTnWItJfCMOOZXFQ6BNnQiboF
64dgJAuWX7w/DL/qbzQhh4YhiGiuqah4hZGVi7Rq3ivcoOd4NIXJsMPLrzlj
vwyx/i0RTwUy1NxRhIXPyqC7+ix79fYRsEpuh9pwR5DfmnK9snsEk38lxNt6
y+FyN40nCJNjqe0M1f9UjvT64MKQDjn4eu+6nCgFJDf55+XbFNg/FtKSalDA
qkJxRNimwLssSao4ZxQuGae3xQWMQtueEMSwViLUqtbctmkUy62W3b1drkSQ
oLbdwU+JbKkwMdx3DGHJoQlb65XQprz+MadjDIEPt79fxBrDppdN3KqIcUz6
2F3yrhrDlcjJw1+Jx9GWxZmftn4cbgJvzhu2CnunSo7R/x4H4/qzIGulCn2r
/OUB7irExWsDthxUg70mgXmtTAWlSpXIVKjRvCcmc5OzGu1HbjRURmvAjNLc
sytWY5muOHObWIND2SEDGx01CL51ba4mdAI5SRaz866Zsier6bvGCTQ4xRk1
dhPYuobj6OKjxb9z5828Lk+gNLu7JI2nRVfNZg3XWotwZc/ZPy11aHVN6rh0
VQvPfvPnfI4Opx9GFI+Yev/uj/dFIh2i3KSxMVwd/juzmbV5ox7TdUzHtXQ9
XNff9fHi6XHcTN2dn6XHXO2r9Ia3eti4s+JW0QgKBzJm6DsJfk7dY7A8QXCQ
sWxFbinB8g3sTo9MAumVafnHMoKmTxk3g08RZG5JOZFeTmDO5W45eYbAIW7J
15H3CXgVT66rcwmyWqR0twcEbSpfv04ewVT7xHBlI4FNwuJfzjURsDo+pZb2
ETz0cvqh+DHB5eOdTBshwb63Xs7NLQQBrmUtv70guHMmpMPwhKDmVml49KCp
Lzq1lN1D8H3xOv+FwwTxQxN1wSbnacwWHlYT0MtmLsTKTLutg5RQQ8A/Qj9w
Uk7Qs3JeIrSmPz640avHCPbQ98/ZEoILDtGRDJMlH2rfPTIQMOXJaze+IcgV
FAS6TxEI73GMUZMEvcGTu7nTBM6s38vzTKYU2RliZwnaaYWZ/BkCS/Hor08/
EBzq5O/oNFkZFiBifiJYkPdo5ajJKE972h9zBFWRndNGI0HXlXOzn/0fdCCF
rg==
         "]]},
       Annotation[#, "Charting`Private`Tag$4250#2"]& ], 
      TagBox[
       {RGBColor[0.560181, 0.691569, 0.194885], AbsoluteThickness[1.6], 
        Opacity[1.], LineBox[CompressedData["
1:eJxFxXss1AEcAPBfNGdYCjMj5xFX0XamGMZI7aK59Zq3seNCTR1rIjeWyOZx
7fJYYxo3Sbpf8opTp3ntOsYO6XAdcR7x85oYyXTVH32/f3z2sYvlXb+pQxAE
+69/P7/KO0oQw77/Xz28MNmni3t3RNTk03CVHcvd1Bg33zoexaDjwrKBuiBv
/JHK0bc8HY/nqu+4buIc2zRhw84ITDHJRiU1Cnu8JT+cU32GJUpVoXpqDJZd
qwl3Gf4C66WWrw4plbChfuRt0cQ4XLXetmDbPwFzM/0Y1NAkLInhcmO6VfBI
0w2BQeNX2IpM5mub1fD23smE6hdTsHbDyKLw9TSsCO5sEYu/wc9ouQwpewaO
9ugK/qTA14r7c04FzsJl3bdKGwZxm1e8CgVbAydL/KtYMlxVSeZpAuZgQ/Fc
0lgPbpPyMIDjNQ8HGbbqmUpxP0Vrr6XbAsxOCIq7JMG92wN/HvFchLdczIrO
NOE9Wak6vLPf4fCdmjTaG3zU0UPj5bAEc0/HMUtq8c6QSP55+jLMDKPqzUR4
Yg5r3MeKgnPj9X8dKsE7rDlaymwFfvc7T9fpCT7QcoESHFuFu23jZUXF+MP2
YNGswRocZq+OjhTgu21MK2faOpyuuzxYloWbOHhyHIkN+N7dkG2DB7iFO1fO
4OPSg5RK/0xcTyC4mJGNV4j7Spfz8Z4lVzd5BW4SZ3z/sRRvd7K+LPqIR/1w
ond24S+zWbLtPtyrOtOcO4THTq20+U/jtNq9gugZnEyixWRo8J19e1rzIl5g
GRFqt4EzNQnOPpv4WH2qNmwLp3s+rRPu4r1EFZ/cwxPl5BX5Pm4kfH9i/gBv
CpXvarX4H7eCgIU=
         "]]},
       Annotation[#, "Charting`Private`Tag$4250#3"]& ]}, {}}, InsetBox[
     TemplateBox[{"\"PCS X\"", "\"1 Round BBPSSW\"", "\"F'=F\""},
      "LineLegend",
      DisplayFunction->(FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ),
      Editable->True,
      InterpretationFunction:>(RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& )], 
     Scaled[{0.8, 0.4}], ImageScaled[{0.5, 0.5}],
     BaseStyle->{FontSize -> Larger},
     FormatType->StandardForm]},
   AspectRatio->1,
   Axes->{True, True},
   AxesLabel->{
     FormBox[
      TagBox["\"F\"", HoldForm], TraditionalForm], 
     FormBox[
      TagBox["\"F'\"", HoldForm], TraditionalForm]},
   AxesOrigin->{0.25000000000000056`, 0.2500000102040826},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   Method->{
    "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> None, 
     "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& )}},
   PlotLabel->FormBox["\"Final vs Initial Fidelity\"", TraditionalForm],
   PlotRange->NCache[{{
       Rational[1, 4], 1}, {0.250000010204082, 0.9999999897959183}}, {{
      0.25, 1}, {0.250000010204082, 0.9999999897959183}}],
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.05], 
      Scaled[0.05]}},
   Ticks->{{{0.25, 
       FormBox["0.25`", TraditionalForm]}, {0.5, 
       FormBox["0.5`", TraditionalForm]}, {0.75, 
       FormBox["0.75`", TraditionalForm]}, {1., 
       FormBox["1.`", TraditionalForm]}}, {{0.25, 
       FormBox["0.25`", TraditionalForm]}, {0.5, 
       FormBox["0.5`", TraditionalForm]}, {0.75, 
       FormBox["0.75`", TraditionalForm]}, {1., 
       FormBox["1.`", TraditionalForm]}}}],
  InterpretTemplate[Legended[
    Graphics[{{{{}, {}, 
        Annotation[{
          Directive[
           Opacity[1.], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]], 
          Line[CompressedData["
1:eJwVzHk41HkAx/FZNpMrhXoY5QpFbVSrRPVJtcLD6nAly8pQWZvUIyHpUD0V
1pZ2N1tbVk2OqU0sU8s2YYXN42ca1+SYGQZzfteRKzU7/fF5Xv+8n4/NwYS9
MVo0Gs1fs0/e2Z2wkEajwONKF39S8bmku16bQrA5P1lnHoXNz8IKr9ApGKly
ug30KAhsvDaYGFFwucb51dyUwpLxpeEOlhR0ssoXr19JIfdm80O/zRRsTY5U
xeymcF5gj1unKLjnNh9rvEchltnz/bpRCgu4bUapnm2Isk7OfTzZhgZ3HWPX
OzzInNlPOmQ8bAiQL8oUvoHbH+y/vhS8gf1eluSxRTs4HYJrPb18/Lbmqxjj
hA407Cnc70K1QzxdwzIr7oRO0i1FS0cH/sk38jGf7YL+/ANxBV2d4MTItQI8
BbirqpRYN3VhzXfCKcOEt2Cmb3OQtXSjyHbMeNfTHnAimczIlwJ0HvWYsu/p
RVvZvmy9J28R1+0RFD/XBwv2sTS1pnMO7HNKNhNiYmbFoXv3e6G1WlAWzhJC
TQzMrpX0YaPVRoZqiwitQTXlpaX96G9+F5hIifAzPdOh2l8IK9OUJN0QMSLc
uEGvWoXYani6vWlIDOX1pgsrfUQQOl6V9ccN4ObLI3mPX4swyKg7XD01AKui
hPxWfzGSOdKltRmDOMbZfterQQwfMUdUODcIwW32JbH3AGxZdd695yTQLx2I
59cOoL0yJ89jTgKrxLPeUe6DqFl+OTTw+BD89Ct0TKoHMRbfMxH13xC2tVbU
MVwlWCtxeMFgDsP/kF/0Lo4E6gxuekr/MDZX+Uwv2DSEelqmMCt4BOMuplmr
y4bge/DKVl7dCGrPJGklrB+Gw7yEshg3KfZPFibTHw1j1PKL+sRCKXj2bmJ3
uxHohgRyX+jJwHSMdr7xYAQRt7qMDFJkqAk+kOZpKYWHrJTv1yeDc6is2LRA
Cv0FJSW+vnIcvuDVucVC0716czzjkRyZsfNnP7shw8lvw5o9DRV4tixKLTOV
g8l87ZJ6QoE/P17SdsqRY8/OD5fC2xRoLt8hy16kgJ14OjTVVYmX1rENWdcV
WOrOc3H8SYmzVUEFIj0llin7V46qlAi17Yk4kK2E4US0qNxfhalKZ4tVdBW+
/j3Wpum+Cqe0pa9vnlEhw4AeJJ5WwdhuU5Q9jSCeZd3yfC/BiaPBE3opBC+K
mtd4PyAw28BsdEgjsOOOa1eyCKo/JN7enk6gpy3iLi8i0MnO3pl6jiA/Z+HY
xxKNpfV50isEST7qtRVPCGpH1rk25hNkm085MqoJjKONTl7UuE9ip8vnEVQ5
LfMt+JugMJsItvIJwsecLGu4BGG2tXnF7QSsc14NE/UEHacvc890EbjfS1/C
bNH89rVMr+gjONgrr9yusUDLWpUkJaA/mLkaISTQqojx7JcRsOPpkalighk5
/7S3gmDyvS396RABL8CNzSAEVxlhITYapen+ypoJAmfxoVVbRgl058zPO0wS
8IuT1KHjBLuqrdU5UwSWm358mKsx4htJWeQsQR3tbhp7hkAW93D41XuCw43s
gEaNoybseS4fCAxyny8f1Bh49J3+Lx8JykIap9Rqgn9/uDj7yf8BNaWG3Q==

           "]]}, "Charting`Private`Tag$4250#1"], 
        Annotation[{
          Directive[
           Opacity[1.], 
           RGBColor[0.880722, 0.611041, 0.142051], 
           AbsoluteThickness[1.6]], 
          Line[CompressedData["
1:eJwVzn0w1HkcB/Atd9bRk4erkIeVKJnW6XTW6N5So7rhKp2IUlikKQ9zs9eD
y1XUjGrLVaazV4eQyp7Lw4nQeOgkQ/vDtuy2tHYtu2t3v5WNqOxtf3zmNe/3
P+8PIz4tPHE+jUYLM91nb+1MW0KjUUiXGSw/q/1CKX5iRsHzqK4oez6FwIbo
klw6hdUWz2kWX1KQMEI22C6mUDkw7mRrSWHp5Ip9Hs4UeEVDXb52FPLyu8pD
AymUeRdKbqymcFayCgXHKdA1L93f76KQxJYe9X1DwaElUGBVTiHO9Vhe5VQv
GNZRriSlFxom/4FI04cCNmc0xrsP/v/wG7+V9EN4m2HvMtWHepHkonRIiLqd
omqhtB8du0r2+lAvsCtjt1PhYyHMOQXaHpEIQ5HGde+bX8DKIuZw8eAA0u19
I4raRCjU1yldnw3ip02NxermAbBPBXloesTYsCYpOUM0iPoDbPaBVgkc8q1P
2yvE6K3azbV88BJubjaPrF9L4MhPzzRWS1GqTnWItJfCMOOZXFQ6BNnQiboF
64dgJAuWX7w/DL/qbzQhh4YhiGiuqah4hZGVi7Rq3ivcoOd4NIXJsMPLrzlj
vwyx/i0RTwUy1NxRhIXPyqC7+ix79fYRsEpuh9pwR5DfmnK9snsEk38lxNt6
y+FyN40nCJNjqe0M1f9UjvT64MKQDjn4eu+6nCgFJDf55+XbFNg/FtKSalDA
qkJxRNimwLssSao4ZxQuGae3xQWMQtueEMSwViLUqtbctmkUy62W3b1drkSQ
oLbdwU+JbKkwMdx3DGHJoQlb65XQprz+MadjDIEPt79fxBrDppdN3KqIcUz6
2F3yrhrDlcjJw1+Jx9GWxZmftn4cbgJvzhu2CnunSo7R/x4H4/qzIGulCn2r
/OUB7irExWsDthxUg70mgXmtTAWlSpXIVKjRvCcmc5OzGu1HbjRURmvAjNLc
sytWY5muOHObWIND2SEDGx01CL51ba4mdAI5SRaz866Zsier6bvGCTQ4xRk1
dhPYuobj6OKjxb9z5828Lk+gNLu7JI2nRVfNZg3XWotwZc/ZPy11aHVN6rh0
VQvPfvPnfI4Opx9GFI+Yev/uj/dFIh2i3KSxMVwd/juzmbV5ox7TdUzHtXQ9
XNff9fHi6XHcTN2dn6XHXO2r9Ia3eti4s+JW0QgKBzJm6DsJfk7dY7A8QXCQ
sWxFbinB8g3sTo9MAumVafnHMoKmTxk3g08RZG5JOZFeTmDO5W45eYbAIW7J
15H3CXgVT66rcwmyWqR0twcEbSpfv04ewVT7xHBlI4FNwuJfzjURsDo+pZb2
ETz0cvqh+DHB5eOdTBshwb63Xs7NLQQBrmUtv70guHMmpMPwhKDmVml49KCp
Lzq1lN1D8H3xOv+FwwTxQxN1wSbnacwWHlYT0MtmLsTKTLutg5RQQ8A/Qj9w
Uk7Qs3JeIrSmPz640avHCPbQ98/ZEoILDtGRDJMlH2rfPTIQMOXJaze+IcgV
FAS6TxEI73GMUZMEvcGTu7nTBM6s38vzTKYU2RliZwnaaYWZ/BkCS/Hor08/
EBzq5O/oNFkZFiBifiJYkPdo5ajJKE972h9zBFWRndNGI0HXlXOzn/0fdCCF
rg==
           "]]}, "Charting`Private`Tag$4250#2"], 
        Annotation[{
          Directive[
           Opacity[1.], 
           RGBColor[0.560181, 0.691569, 0.194885], 
           AbsoluteThickness[1.6]], 
          Line[CompressedData["
1:eJxFxXss1AEcAPBfNGdYCjMj5xFX0XamGMZI7aK59Zq3seNCTR1rIjeWyOZx
7fJYYxo3Sbpf8opTp3ntOsYO6XAdcR7x85oYyXTVH32/f3z2sYvlXb+pQxAE
+69/P7/KO0oQw77/Xz28MNmni3t3RNTk03CVHcvd1Bg33zoexaDjwrKBuiBv
/JHK0bc8HY/nqu+4buIc2zRhw84ITDHJRiU1Cnu8JT+cU32GJUpVoXpqDJZd
qwl3Gf4C66WWrw4plbChfuRt0cQ4XLXetmDbPwFzM/0Y1NAkLInhcmO6VfBI
0w2BQeNX2IpM5mub1fD23smE6hdTsHbDyKLw9TSsCO5sEYu/wc9ouQwpewaO
9ugK/qTA14r7c04FzsJl3bdKGwZxm1e8CgVbAydL/KtYMlxVSeZpAuZgQ/Fc
0lgPbpPyMIDjNQ8HGbbqmUpxP0Vrr6XbAsxOCIq7JMG92wN/HvFchLdczIrO
NOE9Wak6vLPf4fCdmjTaG3zU0UPj5bAEc0/HMUtq8c6QSP55+jLMDKPqzUR4
Yg5r3MeKgnPj9X8dKsE7rDlaymwFfvc7T9fpCT7QcoESHFuFu23jZUXF+MP2
YNGswRocZq+OjhTgu21MK2faOpyuuzxYloWbOHhyHIkN+N7dkG2DB7iFO1fO
4OPSg5RK/0xcTyC4mJGNV4j7Spfz8Z4lVzd5BW4SZ3z/sRRvd7K+LPqIR/1w
ond24S+zWbLtPtyrOtOcO4THTq20+U/jtNq9gugZnEyixWRo8J19e1rzIl5g
GRFqt4EzNQnOPpv4WH2qNmwLp3s+rRPu4r1EFZ/cwxPl5BX5Pm4kfH9i/gBv
CpXvarX4H7eCgIU=
           "]]}, "Charting`Private`Tag$4250#3"]}}, {}}, {
     DisplayFunction -> Identity, 
      Ticks -> {{0.25, 0.5, 0.75, 1.}, {0.25, 0.5, 0.75, 1.}}, 
      AxesOrigin -> {0.25000000000000056`, 0.2500000102040826}, 
      FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
      GridLines -> {None, None}, DisplayFunction -> Identity, 
      PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}}, PlotRangeClipping -> True, ImagePadding -> All, 
      DisplayFunction -> Identity, AspectRatio -> 1, Axes -> {True, True}, 
      AxesLabel -> {
        HoldForm["F"], 
        HoldForm["F'"]}, AxesOrigin -> {0.25, 0.250000010204082}, 
      DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
      FrameLabel -> {{None, None}, {None, None}}, 
      FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
      GridLines -> {None, None}, GridLinesStyle -> Directive[
        GrayLevel[0.5, 0.4]], 
      Method -> {
       "DefaultBoundaryStyle" -> Automatic, 
        "DefaultGraphicsInteraction" -> {
         "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
          "Effects" -> {
           "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
            "Droplines" -> {
             "freeformCursorMode" -> True, 
              "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
        "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> 
        None, "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}}, PlotLabel -> "Final vs Initial Fidelity", 
      PlotRange -> {{
         Rational[1, 4], 1}, {0.250000010204082, 0.9999999897959183}}, 
      PlotRangeClipping -> True, PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.02], 
         Scaled[0.02]}}, 
      Ticks -> {{0.25, 0.5, 0.75, 1.}, {0.25, 0.5, 0.75, 1.}}}], 
    Placed[
     Unevaluated[
      LineLegend[{
        Directive[
         Opacity[1.], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        Directive[
         Opacity[1.], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        Directive[
         Opacity[1.], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]]}, {"PCS X", "1 Round BBPSSW", "F'=F"}, 
       LegendMarkers -> None, LabelStyle -> {}, LegendLayout -> "Column"]], {
     0.8, 0.4}, Identity]]& ],
  AutoDelete->True,
  Editable->True,
  SelectWithContents->False,
  Selectable->True]], "Output",
 CellChangeTimes->{
  3.9195526537802343`*^9, 3.9195538085151377`*^9, 3.919553871866272*^9, 
   3.919553906481825*^9, 3.919555152935402*^9, 3.91955521536489*^9, {
   3.9195553770480995`*^9, 3.919555387289107*^9}, 3.9195566460900717`*^9, 
   3.919556987957919*^9, 3.91956323195881*^9, 3.919563478232644*^9, 
   3.919566596414689*^9, 3.919566650754675*^9, {3.919566722605297*^9, 
   3.919566726775533*^9}, {3.91956712905987*^9, 3.9195671517859*^9}, 
   3.919567465695692*^9, 3.9195997040452895`*^9, 3.9198619785477204`*^9, 
   3.9198620303059*^9, 3.920141822480544*^9, 3.9201418864625683`*^9, 
   3.9201419663896437`*^9, 3.920142036140882*^9, 3.9201421919471273`*^9, {
   3.9201422633930717`*^9, 3.9201423122633076`*^9}, {3.9201423504858847`*^9, 
   3.9201423691858597`*^9}, 3.9201424414726825`*^9, 3.9201431831288924`*^9, {
   3.9201434763068724`*^9, 3.9201434896319056`*^9}, 3.9201512864411993`*^9, 
   3.920151926245971*^9, {3.9201600398212767`*^9, 3.9201600663179455`*^9}, 
   3.920315284449258*^9, 3.925560809502965*^9, 3.925560967681635*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"81697b72-940b-4fac-bd07-df746866a52e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bbpFid", "[", "F", "]"}], "//", 
  "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pcsFid", "[", "F", "]"}], "//", 
  "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{"postrInitialF", "//", "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{"fidelityInitialF", "//", "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{"fidelity", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.920142716092327*^9, 3.9201427175648355`*^9}, {
  3.920142780569544*^9, 3.920142796861597*^9}, {3.9201431869896994`*^9, 
  3.920143201405101*^9}, {3.920143242443708*^9, 3.920143276691333*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"f3b3c209-88fc-40d5-9244-07dabb0365af"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    SuperscriptBox["F", "2"], "+", 
    RowBox[{
     FractionBox["1", "9"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "F"}], ")"}], "2"]}]}], 
   RowBox[{
    SuperscriptBox["F", "2"], "+", 
    RowBox[{
     FractionBox["5", "9"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "F"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", "F", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "F"}], ")"}]}]}]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9201427182226696`*^9, {3.9201427829910717`*^9, 3.9201427974561667`*^9}, {
   3.920143183157883*^9, 3.9201432023231997`*^9}, {3.920143247423588*^9, 
   3.9201432773941016`*^9}, {3.9201434763417807`*^9, 3.9201434896632776`*^9}, 
   3.9201512864691234`*^9, 3.920151926271904*^9, {3.9201600398521943`*^9, 
   3.920160066345601*^9}, 3.920315284476252*^9, 3.9255608095298376`*^9, 
   3.9255609677275543`*^9},
 CellLabel->
  "Out[48]//TraditionalForm=",ExpressionUUID->"c7ffaa92-1aaf-4a09-bfaa-\
7a3e667f8bcb"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"9", " ", 
    SuperscriptBox["F", "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "F"}], "+", "1"}], ")"}], "2"]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9201427182226696`*^9, {3.9201427829910717`*^9, 3.9201427974561667`*^9}, {
   3.920143183157883*^9, 3.9201432023231997`*^9}, {3.920143247423588*^9, 
   3.9201432773941016`*^9}, {3.9201434763417807`*^9, 3.9201434896632776`*^9}, 
   3.9201512864691234`*^9, 3.920151926271904*^9, {3.9201600398521943`*^9, 
   3.920160066345601*^9}, 3.920315284476252*^9, 3.9255608095298376`*^9, 
   3.925560967732498*^9},
 CellLabel->
  "Out[49]//TraditionalForm=",ExpressionUUID->"7331ef4c-fb39-4f32-9b5d-\
6ec2e4e6088d"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", "9"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "F"}], "+", "1"}], ")"}], "2"]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9201427182226696`*^9, {3.9201427829910717`*^9, 3.9201427974561667`*^9}, {
   3.920143183157883*^9, 3.9201432023231997`*^9}, {3.920143247423588*^9, 
   3.9201432773941016`*^9}, {3.9201434763417807`*^9, 3.9201434896632776`*^9}, 
   3.9201512864691234`*^9, 3.920151926271904*^9, {3.9201600398521943`*^9, 
   3.920160066345601*^9}, 3.920315284476252*^9, 3.9255608095298376`*^9, 
   3.9255609677365203`*^9},
 CellLabel->
  "Out[50]//TraditionalForm=",ExpressionUUID->"1908c607-7400-46e9-918a-\
0272b4b7c3cc"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"9", " ", 
    SuperscriptBox["F", "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "F"}], "+", "1"}], ")"}], "2"]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9201427182226696`*^9, {3.9201427829910717`*^9, 3.9201427974561667`*^9}, {
   3.920143183157883*^9, 3.9201432023231997`*^9}, {3.920143247423588*^9, 
   3.9201432773941016`*^9}, {3.9201434763417807`*^9, 3.9201434896632776`*^9}, 
   3.9201512864691234`*^9, 3.920151926271904*^9, {3.9201600398521943`*^9, 
   3.920160066345601*^9}, 3.920315284476252*^9, 3.9255608095298376`*^9, 
   3.9255609677405186`*^9},
 CellLabel->
  "Out[51]//TraditionalForm=",ExpressionUUID->"31c24389-699e-4d0a-9899-\
9bfa36fa7fbe"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"9", " ", 
        RowBox[{"(", 
         RowBox[{"p1", "-", "2"}], ")"}], " ", "p1"}], "+", "10"}], ")"}], 
     " ", 
     SuperscriptBox["p2", "2"]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"20", "-", 
       RowBox[{"9", " ", "p1"}]}], ")"}], " ", "p1", " ", "p2"}], "+", 
    RowBox[{"2", " ", "p1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"5", " ", "p1"}], "-", "12"}], ")"}]}], "-", 
    RowBox[{"24", " ", "p2"}], "+", "16"}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p1", "-", "2"}], ")"}], " ", "p1"}], "+", "2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p2", "-", "2"}], ")"}], " ", "p2"}], "+", "2"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9201427182226696`*^9, {3.9201427829910717`*^9, 3.9201427974561667`*^9}, {
   3.920143183157883*^9, 3.9201432023231997`*^9}, {3.920143247423588*^9, 
   3.9201432773941016`*^9}, {3.9201434763417807`*^9, 3.9201434896632776`*^9}, 
   3.9201512864691234`*^9, 3.920151926271904*^9, {3.9201600398521943`*^9, 
   3.920160066345601*^9}, 3.920315284476252*^9, 3.9255608095298376`*^9, 
   3.925560967745499*^9},
 CellLabel->
  "Out[52]//TraditionalForm=",ExpressionUUID->"0b1b37fd-06ed-41b5-93ba-\
5fb1c78816a5"]
}, Open  ]]
},
WindowSize->{1429.5, 735.75},
WindowMargins->{{1150.5, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b35288a0-95ac-4aeb-96e8-89023012b9c2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 8228, 217, 390, "Input",ExpressionUUID->"d2ced899-cbe4-4892-9748-7d52c6fceb2c"],
Cell[CellGroupData[{
Cell[8811, 241, 451, 12, 28, "Input",ExpressionUUID->"68c56d38-81ca-411e-ad33-1861cc532262"],
Cell[9265, 255, 1794, 29, 32, "Output",ExpressionUUID->"fd147908-69d2-4ded-a993-e40b475f6632"]
}, Open  ]],
Cell[11074, 287, 1814, 51, 162, "Input",ExpressionUUID->"861ce564-51fd-485b-b7f2-9ceab5258ddf"],
Cell[CellGroupData[{
Cell[12913, 342, 5723, 128, 314, "Input",ExpressionUUID->"2ef2a9ff-6c33-46f9-bd82-8935d63a7840"],
Cell[18639, 472, 8866, 284, 184, "Output",ExpressionUUID->"6adce922-939e-4a4b-a043-539f0b4905c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27542, 761, 304, 5, 28, "Input",ExpressionUUID->"a018e5af-a856-4048-bd0b-cd6d3ca98604"],
Cell[27849, 768, 1424, 20, 32, "Output",ExpressionUUID->"ba4f5ad0-ecfd-4a79-ac1e-952718100be5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29310, 793, 458, 9, 28, "Input",ExpressionUUID->"ec1c506a-2583-4b4b-bf7a-5a12048b21eb"],
Cell[29771, 804, 2153, 51, 53, "Output",ExpressionUUID->"6369a511-9cf8-41ed-aa74-baa1cfa46d32"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31961, 860, 456, 9, 28, "Input",ExpressionUUID->"05cc495f-0809-4f07-a59f-b8ac8f80da24"],
Cell[32420, 871, 1422, 30, 48, "Output",ExpressionUUID->"a3dbae78-3a4b-4636-90c4-ca47cb7a8e84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33879, 906, 212, 3, 28, "Input",ExpressionUUID->"e920c2fd-5117-47ef-bee6-9785350dc929"],
Cell[34094, 911, 372, 8, 64, "Output",ExpressionUUID->"41b3d30a-430f-4f13-81b3-b10fead573aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34503, 924, 139, 2, 28, "Input",ExpressionUUID->"78b3e26e-23d4-495d-bf04-d658f8513c6f"],
Cell[34645, 928, 231, 5, 47, "Output",ExpressionUUID->"a053dad2-b094-4eb2-b7cf-450b179577f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34913, 938, 1007, 25, 86, "Input",ExpressionUUID->"9be26d42-3bab-4c92-9f09-20c972a59e83"],
Cell[35923, 965, 1605, 34, 54, "Output",ExpressionUUID->"643e1863-a96b-44bf-838b-b3515d5c9494"],
Cell[37531, 1001, 1409, 27, 48, "Output",ExpressionUUID->"6528cf34-5cd8-4dbf-b5ea-e9d923e28c76"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38977, 1033, 776, 19, 67, "Input",ExpressionUUID->"91f6967f-4a47-4056-b4cb-5324118e81ea"],
Cell[39756, 1054, 908, 17, 48, "Output",ExpressionUUID->"5fa4e58a-9828-4c83-a89e-22837a5b3f42"],
Cell[40667, 1073, 1447, 38, 48, "Output",ExpressionUUID->"12719af9-edfb-4c70-a2f2-57d349bb7456"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42151, 1116, 1522, 45, 124, "Input",ExpressionUUID->"c78068d1-473b-4552-94f2-093edddb01a3"],
Cell[43676, 1163, 1177, 21, 53, "Output",ExpressionUUID->"a7ff3d03-4722-4d74-a2c8-e50927cd7461"],
Cell[44856, 1186, 1154, 20, 48, "Output",ExpressionUUID->"850f181e-3d75-4382-b03f-669b684f4f57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46047, 1211, 1755, 39, 48, "Input",ExpressionUUID->"ab7fb2a6-413e-47cb-b87c-617eae9322a9"],
Cell[47805, 1252, 16769, 355, 379, "Output",ExpressionUUID->"e51ec832-5b96-4f9b-981d-b111eb7e762a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64611, 1612, 3056, 82, 110, "Input",ExpressionUUID->"41b44690-48f2-424f-b9be-ae24e866654d"],
Cell[67670, 1696, 21928, 457, 379, "Output",ExpressionUUID->"81697b72-940b-4fac-bd07-df746866a52e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89635, 2158, 725, 13, 105, "Input",ExpressionUUID->"f3b3c209-88fc-40d5-9244-07dabb0365af"],
Cell[90363, 2173, 1089, 30, 81, "Output",ExpressionUUID->"c7ffaa92-1aaf-4a09-bfaa-7a3e667f8bcb"],
Cell[91455, 2205, 759, 19, 68, "Output",ExpressionUUID->"7331ef4c-fb39-4f32-9b5d-6ec2e4e6088d"],
Cell[92217, 2226, 735, 18, 63, "Output",ExpressionUUID->"1908c607-7400-46e9-918a-0272b4b7c3cc"],
Cell[92955, 2246, 761, 19, 68, "Output",ExpressionUUID->"31c24389-699e-4d0a-9899-9bfa36fa7fbe"],
Cell[93719, 2267, 1457, 42, 68, "Output",ExpressionUUID->"0b1b37fd-06ed-41b5-93ba-5fb1c78816a5"]
}, Open  ]]
}
]
*)

